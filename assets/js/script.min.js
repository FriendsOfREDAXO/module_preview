let $showModulePreview,slicePosition,slice,$modules,$modulePreview,$close,$body,$html,previewActive,moduleAdded=!1;function showModulePreview(){previewActive=!0,$modulePreview.fadeIn(),$body.addClass("module-preview"),$body.css("height","auto"),$html.css("overflow","hidden"),$body.addClass("modal-open");for(let e=0;e<$modules.length;e++){const o=$modules.eq(e).data("href");$modules.eq(e).attr("href",o+"&slice_id="+slice+"#"+slicePosition)}}function hideModulePreview(){$modulePreview.fadeOut(function(){previewActive=!1,$body.removeClass("module-preview"),$body.css("height","100%"),$html.css("overflow","initial"),$body.removeClass("modal-open"),moduleAdded&&setTimeout(function(){$("html,body").scrollTop($("#REX_FORM").offset().top),moduleAdded=!1},10)})}$(document).on("rex:ready",function(){$showModulePreview=$("button.show-module-preview"),$modulePreview=$("#module-preview"),$close=$modulePreview.find(".close"),$body=$("body"),$html=$("html"),$modules=$modulePreview.find("a.module"),hideModulePreview(),$modules.off("click"),$showModulePreview.off("click"),$close.off("click"),$modules.on("click",function(){const e=$(this);moduleAdded=!0,new RegExp("\\bpage="+rex.page+"(\\b[^/]|$)").test(e.attr("href"))&&hideModulePreview()}),$showModulePreview.on("click",function(e){e.preventDefault(),slicePosition=$(this).parents("li").attr("id"),slice=$(this).data("slice"),previewActive?hideModulePreview():showModulePreview()}),$close.on("click",function(e){e.preventDefault(),hideModulePreview()})}),$(document).on("keyup",function(e){"Escape"===e.key&&hideModulePreview()});
